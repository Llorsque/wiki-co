(async function(){const sb=document.getElementById('globalSearch');const results=document.getElementById('globalResults');if(!sb||!results)return;const idx=await fetch('/search.json?'+Date.now()).then(r=>r.json());const norm=t=>t.toLowerCase().normalize('NFD').replace(/\p{Diacritic}/gu,'');sb.addEventListener('input',e=>{const q=norm(e.target.value.trim());if(!q){results.innerHTML='';return;}const list=idx.filter(it=>{const hay=norm([it.title,it.category,it.content].join(' '));return hay.includes(q)}).slice(0,40);results.innerHTML=list.map(r=>`<div class="card"><a href="${r.url}"><strong>${r.title}</strong></a><p>${r.snippet||''}</p></div>`).join('');});})();